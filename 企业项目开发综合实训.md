# 企业项目开发综合实训

## 一、需求分析

### 1、后台功能

> 商品模块（product微服务模块）

CRUD操作。包括后台商品库存管理、上货、出货、编辑管理和商品分类管理、商品品牌管理等。

* 商品分类表（category）

  |    列名     | 数据类型 | 长度 | null？ |      说明       |
  | :---------: | :------: | :--: | :----: | :-------------: |
  | category_id |   int    |      |   否   |   主键，自增    |
  |  type_name  | varchar  |  50  |   是   |   商品分类名    |
  |    sort     |   int    |      |   否   | 排序号，默认为1 |

* 商品表(product)

  |    列名    | 数据类型 | 长度 | null？ |               说明                |
  | :--------: | :------: | :--: | :----: | :-------------------------------: |
  | product_id |   int    |      |   否   |            主键，自增             |
  |    name    | varchar  |  50  |        |              商品名               |
  | mark_price |  float   |      |        |              市场价               |
  |   price    |  float   |      |        |             现价价格              |
  |  quality   |   int    |      |        |             库存数量              |
  |    hit     |   int    |      |        |              浏览量               |
  |    time    |   date   |      |        |             上架时间              |
  |   photo    | varchar  | 200  |        |               封面                |
  |    t_id    |   int    |      |   否   | 商品分类-外键category.category_id |
  |  content   |   text   |      |        |             商品介绍              |


> 订单模块（order微服务模块）

在线订单程序，使消费者能够顺利的通过Web在线的方式，直接生成购买订单。 

* 订单表（order）

  |    列名     | 数据类型 | 长度 | null？ |                    说明                     |
  | :---------: | :------: | :--: | :----: | :-----------------------------------------: |
  |  order_id   | varchar  |  50  |   否   |      主键，时间戳+username+三位随机数       |
  | order_time  | datetime |      |        |                  下单时间                   |
  | address_id  |   int    |      |   否   | 会员对应收货地址信息-外键address.address_id |
  | total_price |  float   |      |        |                   总价格                    |
  |   content   |   text   | 200  |        |                    备注                     |
  |    v_id     |   int    |      |        |         对应会员信息-外键vip.vip_id         |
  |   status    |   int    |  20  |   否   |   0未付款 1未发货 2未签收 3未确认 4未评价   |

* 订单条目表（order_item）

  |    列名     | 数据类型 | 长度 | null？ |             说明              |
  | :---------: | :------: | :--: | :----: | :---------------------------: |
  |     id      |   int    |      |   否   |          主键，自增           |
  |  buy_count  |   int    |  10  |   否   |           购买数量            |
  | total_price |  float   |      |   否   |            总价格             |
  |    p_id     |   int    |      |   否   | 商品id-外键product.product_id |
  |    o_id     |  vachar  |      |   否   | 对应订单号-外键order.order_id |

  

> 评论模块（comment微服务模块）

购买过产品的买家可以对产品进行评价和打分。

* 评论信息表(comment)

  |    列名    | 数据类型 | 长度 | null？ |             说明              |
  | :--------: | :------: | :--: | :----: | :---------------------------: |
  | comment_id |   int    |  20  |   否   |          主键，自增           |
  |    p_id    |   int    |      |   否   | 商品id-外键product.product_id |
  |    v_id    |   int    |      |   否   |    评论人id-外键vip.vip_id    |
  |  content   |   text   | 300  |        |           评论内容            |
  |   stars    |   int    |  10  |   否   |         星级 1-5颗星          |

  

> 支付模块（pay微服务模块）

即通过网上钱包、电子支付卡。进行网上资金流转换的业务流程；国内主流支付方式包括：腾讯旗下的财付通、支付宝、网银在线等。

> 会员模块（vip微服务模块）

在购物系统中，集成会员注册是吸引会员进行二次购买和提升转换率最好的方式。

* 会员表（vip）

  |      列名       | 数据类型 | 长度 | null？ |     说明     |
  | :-------------: | :------: | :--: | :----: | :----------: |
  |     vip_id      |   int    |  20  |   否   |  主键，自增  |
  |    username     | varchar  |  20  |   否   |    用户名    |
  |      name       | varchar  |  20  |        |     姓名     |
  |    password     | varchar  |  20  |   否   |     密码     |
  |       sex       | varchar  |  10  |        |     性别     |
  |      email      | varchar  |  25  |        |   电子邮箱   |
  |      photo      | varchar  | 200  |        |     头像     |
  |      score      |   int    |  10  |        |     等级     |
  |    question     | varchar  | 200  |        | 密码提示问题 |
  |     answer      | varchar  | 200  |        |     答案     |
  | last_login_time | datetime |      |        | 上次登陆时间 |

  

> 信息模块（information微服务模块）

用于发布商城系统相关的一些信息。例如，广告，通知等

* 商城信息表（information）

  |      列名      | 数据类型 | 长度 | null？ |    说明    |
  | :------------: | :------: | :--: | :----: | :--------: |
  | information_id |   int    |  20  |   否   | 主键，自增 |
  |     title      | varchar  | 200  |   否   |  信息标题  |
  |     photo      | varchar  | 200  |        |  信息封面  |
  |    content     |   text   | 500  |        |  信息内容  |

  

> 配送模块（express微服务模块）

购物系统集成的物流配送方式，从而方便消费者对物流方式进行在线选择。如：EMS、顺风等等。

* 配送地址信息表(address)

  |     列名      | 数据类型 | 长度 | null？ |           说明            |
  | :-----------: | :------: | :--: | :----: | :-----------------------: |
  |  address_id   |   int    |  20  |   否   |        主键，自增         |
  |   province    | varchar  |  20  |        |            省             |
  |     city      | varchar  |  20  |        |            市             |
  |     area      | varchar  |  20  |        |            区             |
  | total_address | varchar  |  50  |        |         详细地址          |
  |   postcode    | varchar  |  20  |        |           邮编            |
  |   receiver    | varchar  |  20  |        |          收货人           |
  |     phone     | varchar  |  20  |        |         联系电话          |
  |     v_id      |   int    |      |   否   | 对应会员id-外键vip.vip_id |

* 物流表（express）

  |      列名      | 数据类型 | 长度 | null？ |              说明              |
  | :------------: | :------: | :--: | :----: | :----------------------------: |
  |   express_id   |   int    |  20  |   否   |           主键，自增           |
  |      o_id      | varchar  |      |   否   | 对应订单号，外键order.order_id |
  | express_number | varchar  |  50  |   否   |            快递单号            |
  |  express_name  | varchar  |  20  |        |           快递公司名           |

> 商品促销（promotion 微服务模块）

购物系统都有商品促销功能，通过商品促销功能，能够迅速的促进商城的消费积极性。

* 商品促销表(promotion)

  |      列名       | 数据类型 | 长度 | null？ |             说明              |
  | :-------------: | :------: | :--: | :----: | :---------------------------: |
  |  promotion_id   |   int    |  20  |   否   |          主键，自增           |
  |      p_id       |   int    |      |   否   | 商品id-外键product.product_id |
  | promotion_price |  float   |  20  |        |           促销价格            |
  |    discount     |  float   |  10  |        |           促销折扣            |
  |      count      |   int    |  20  |        |             数量              |
  |      state      |   int    |  10  |   否   |   促销方式 1：折扣 2：价格    |

> 登录模块（account微服务模块）

会员和商城管理员的登录入口。

* 管理员信息表(admin)

|   列名   | 数据类型 | 长度 | null？ |    说明    |
| :------: | :------: | :--: | :----: | :--------: |
| admin_id |   int    |  20  |   否   | 主键，自增 |
| username | varchar  |  20  |   否   |   用户名   |
| password | varchar  |  22  |   否   |    密码    |
|   name   | varchar  |  20  |   否   |    姓名    |

### 2、前端功能

前端使用 Thymeleaf 模板，通过 Spring Boot 与后端进行交互，实现与后端相对应的功能

## 二、概要分析

整个系统由 一个服务注册中心、一个服务配置中心，若干个服务提供者 和 一个 服务消费者构成。具体如下：

1、服务注册中心—— Eureka Server

利用 Spring Cloud Eureka 搭建一个服务注册中心，将所有的服务提供者和服务消费者全部交由注册中心进行统一注册。

2、服务配置中心——Config Server

所有的服务提供者和服务消费者的配置文件全部交由服务配置中心统一管理，便于对配置的修改和管理。

3、服务提供者

每个服务提供者提供一个相应的功能，具体如下：

* 登录微服务模块——account

  负责网站管理员和网站会员的登录退出功能。

* 商品微服务模块——product

  负责商品信息的相关CRUD操作。

* 订单微服务模块——order

  负责商品下单后订单的生成、下单后的查询、订单条目的生成等功能。

* 评论微服务模块——comment

  负责会员在下单后的评论功能

* 会员微服务模块——vip

  负责会员信息的CRUD操作。

* 信息微服务模块——information

  负责网站的广告投放信息和公告信息的添加和删除

* 配送微服务模块——express

  负责物品配送信息的查看和添加

* 促销微服务模块——promotion

  服务商品促销的相关功能实现

* 支付微服务模块——pay

  调用各大公司的支付API，实现支付功能

4、服务消费者——client

服务消费者负责对服务提供者功能的调用并和前端进行交互，实现相应的功能，所有的前端页面全部交由服务消费者进行调用。

## 三、功能分析

### 1、订单功能

* 直接购买

  1，将商品id  ，购买数量 ，购买人的会员 id，带过来 ，后台计算出总价格 。

  2，生成一个商品订单

  3，根据订单 id 生成条目表。

  4，根据订单条目表 完善 订单信息。

  5，用户收货地址，订单信息，对应订单条目信息传至前端显示。

* 购物车购买

  1，将 购物车 id 数组 和会员id 带过来

  2，生成一个商品订单

  3，根据订单id 循环生成 订单条目表

  4，根据订单条目表完善 订单 信息

  5，用户收货地址列表，订单信息，对应订单条目表传至前端显示。

## 2、地址显示

直辖市

市 区/县 详细地址

省

省 市 区/县 详细地址 